# TPMesh 模组使用说明书 

# V1. 1目 录

## 1. 产品特点 ................................................................................................. 1

## 2. 快速入门 ................................................................................................. 1

## 3. 产品概述 ................................................................................................. 4

3.1. 基本参数 ........................................................................................................ 4

3.2. 机械尺寸 ........................................................................................................ 5

3.3. 引脚定义 ........................................................................................................ 6

## 4. 产品功能 ................................................................................................. 7

4.1. 通信地址定义 ................................................................................................ 8

4.2. 按需组网 ........................................................................................................ 9

4.3. 多中心节点 .................................................................................................... 9

4.4. 多备选路径 .................................................................................................. 10 

4.5. 路径优化 ...................................................................................................... 10 

4.6. 跳频通信 ....................................................................................................... 11 

4.7. 发送对象 ....................................................................................................... 11 

4.8. 送达确认模式 .............................................................................................. 12 

4.9. 功耗模式 ...................................................................................................... 12 

4.10. 低功耗组网 ................................................................................................ 13 

4.11. 大文件代理传输 ......................................................................................... 14 

4.12. 参考指标 .................................................................................................... 14 

4.12.1. 时延 ................................................................................................. 14 

4.12.2. 待机功耗 ......................................................................................... 15 

4.12.3. 发送功耗 ......................................................................................... 15 

## 1. AT 指令详细描述 ................................................................................. 16 

1.1. AT 接口配置 ................................................................................................. 16 

1.2. AT 指令 ......................................................................................................... 16 1.3. 命令格式 ...................................................................................................... 16 

1.4. 命令分类说明 .............................................................................................. 17 

1.5. 通用指令 ...................................................................................................... 17 

1.5.1. AT ................................................................................................... 17 

1.5.2. 配置 AT 串口 UART ........................................................................ 18 

1.5.3. 查询 AT 串口 UART ........................................................................ 18 

1.5.4. 查询固件版本 VER ........................................................................ 19 

1.5.5. 软重启 REBOOT .............................................................................. 19 

1.5.6. 查询 ESN ........................................................................................ 19 

1.6. 配置指令 ...................................................................................................... 20 

1.6.1. 配置通信地址 ADDR ....................................................................... 20 

1.6.2. 查询通信地址 ADDR ....................................................................... 20 

1.6.3. 配置小区 ID ...................................................................................... 21 

1.6.4. 查询小区 ID ...................................................................................... 21 

1.6.5. 配置发射功率 PWR .......................................................................... 22 

1.6.6. 查询发射功率 PWR .......................................................................... 22 

1.6.7. 配置唤醒周期 WOR ......................................................................... 22 

1.6.8. 查询唤醒周期 WOR ......................................................................... 23 

1.6.9. 配置通信速率 BPS ........................................................................... 23 

1.6.10. 查询通信速率 BPS ......................................................................... 24 

1.6.11. 配置功耗模式 LP ............................................................................ 24 

1.6.12. 查询功耗模式 LP ............................................................................ 24 

1.6.13. 配置持续工作时间 AWAKE .......................................................... 25 

1.6.14. 查询持续工作时间 AWAKE .......................................................... 25 

1.7. 通信指令 ...................................................................................................... 26 

1.7.1. 数据发送 SEND .............................................................................. 26 

1.8. URC 指示 ..................................................................................................... 27 

1.8.1. 模组完成重启 ............................................................................... 27 

1.8.2. 模组 AT 接口就绪 ......................................................................... 27 1.8.3. 路由创建 ....................................................................................... 27 

1.8.4. 路由删除 ....................................................................................... 27 

1.8.5. 模组进入休眠 ............................................................................... 28 

1.8.6. 模组退出休眠 ............................................................................... 28 

1.8.7. 数据接收 ....................................................................................... 28 

1.8.8. 数据发送过程 ............................................................................... 29 

1.8.9. 送达确认 ....................................................................................... 30 

1.8.10. 泛洪数据接收 ............................................................................. 30 1. 产品特点 

#  TPMesh 自组网组网协议 

#  无需提前组网，按需发现路由 

#  支持多中心节点 

#  确定性路由，多备选路径 

#  动态路径优化 

#  跳频通信 

#  支持广播、组播、点播、泛洪传输 

#  支持低功耗组网场景 

#  支持频段 470MHz ～510MHz 

#  支持空中唤醒 

#  AT 指令配置 

#  支持大文件代理传输 

#  2. 6～3.6V 电源供电 

# 2. 快速入门 

TPMesh 是一种源触发的按需路由方案，其主体思想是设备无需先注册，当 

需要发送数据时，如果不存在到目标节点的有效路径时，可以发起寻找目标节 

点的路由发现报文，当目标节点收到路由发现报文后应答路由回复报文，此时 

路由便建立起来，可以正常通信； 

网络中设计的设备分为三种角色：中心节点，路由节点，叶子节点。 

中心节点：整个网络允许存在多个，具备全部路由的全路径信息，提供运 维，诊断等手段维护网络拓扑； 

路由节点：具备到中心节点的全路径信息，负责为上位机提供业务数据收 

发通道，额外承担业务数据的转发，路由维护的功能； 

叶子节点：具备到中心节点的全路径信息，负责为上位机提供业务数据收 

发通道，不承担业务转发功能； 

当每个节点都是中心节点时，网络为纯 mesh 网络； 

当若干个节点时中心节点时，网络为多中心树形网络； 

路由节点和叶子节点通常可以相互转换，在特定的使用场景下可以对部分 

节点强行配置为叶子节点从而达到低功耗的需求； 

节点的身份由配置的通信地址决定； 

TPMesh 模块 工作的频段为： 470MHz ～510MHz 。使用串口进行数据收发，降 

低了无线应用的门槛，可实现 一对一， 一对多 ，多对多 的通信，轻松满足各种 

组网需求。 

收发测试： 

本例采用如下参数进行配置： 

参数 模组 A（中心节点 ） 模组 B（普通节点 ）

节点地址 0x FFFE 0x 1111 

1. 使用串口分别将模组 A 和模组 B 接入 PC 机（ AT 串口）； 

2. 启 动 两 个 串 口 工 具 软 件 ， 选 择 对 应 AT 串 口 号 ， 点 击 打 开 串 口 

（1152 00 bps,8N1 ）

3. 开始配置 

(1) 通过 AT+ADDR 指令配置通信地址； (2) 通过 AT+CELL 配置业务小区（可选）； 

4. 收发测试 

(1) 模组 B 发送业务数据给模组 A；

(2) 模组 A 接收业务数据； 3. 产品概述 

## 3.1. 基本参数   

> 表1参数列表

类别 参数 取值 

## 无线 参数 

工作 频段 470 ～510MHz( 可配置 )

发射 功率 -30dBm ～+20 dBm 

接收灵敏度 -1 12 dbm@ 19 .2Kbps 

-1 07 dbm@ 76.8 Kbps 

调制方式 FSK 

工作带宽 ＜200kHz 单载波（可配置） 

空口速率 19.2kbps/ 76.8kbps 

天线接口 LCC 焊盘 

## 硬件参数 

工作电压 2.6 V ～ 3.6V 典型应用 3.3V 

应用接口 

1. AT 串口： TTL 电平，默认波特率 1152 00bps 

2. 调试串口： TTL 电平，默认波特率 2304 00bps 

3. RI 信号 

5. Wake 信号 

6. LED 指示网络状态 

7. SWD 烧录调试 

工作电流（典型 

值） 

发射电流 85.5mA@3V3 470 MHz +20dBm 

接收电流 16. 5mA@3V3 470 MHz 76.8kbps 

休眠电流 2.2u A@3V3 

工作温度 -40℃～ +85 ℃

存储温度 -4 0℃～ +85 ℃

尺寸 17.7 ( ± 0.15mm) x15.8 ( ± 0.15mm) x2.0mm ( ±

0.2mm) 

管脚数 44

封装接口 LCC SMT 表贴 3.2. 机械尺寸 

该章节描述了模块的机械尺寸，所有的尺寸单位为毫米；所有未标注公差 

的尺寸，公差为 ±0.05mm 。    

> 图2俯视及侧视尺寸图
> 图3底视尺寸图

## 3.3. 引脚定义      

> 图4引脚 标号顺序
> 表2LCC 封装引脚定义

管脚 名称 类 功能说明 

1 GND P 电源地 

2 NC NC NC 

3 NC NC NC 

4 NC NC NC 

5 NC NC NC 

6 NC NC NC 

7 NC NC NC 

8 NC NC NC 

9 NC NC NC 

10 GND P 电源地 

11 SWDIO IO SW 数据 , 建议预留接口便于升级、调试 

12 NC NC NC 

13 SWCLK IO SW 时钟 , 建议预留接口便于升级、调试 

14 NC 

15 RESET_N I 模组复位，低电平有效，拉低至少 

5ms( 模组内部有上拉及滤波电容 )

16 LED_NET O 网络状态指示， LED 驱动 

17 AT_RXD I AT 串口接收，从 DTE 设备 TXD 端接 

收数据 4. 产品功能 

基本功能框图： 

18 AT_TXD O AT 串口发送，发送数据到 DTE 设备的 RXD 端

19 NC NC NC 

20 RI O 振铃提示，有数据通信模组唤醒 DTE ，下降沿 /

低电平有效 

21 ～

23 NC NC NC 

24 VDD_EXT P VDD 输出电源，可用于外部 IO 上拉，并联一 个

2.2uF 的旁路电容，不用则可悬空 

25/26 NC NC NC 

27 GND P 电源地 

28 NC NC NC 

29 NC NC NC 

30 NC IO NC 

31 NC IO NC 

32 GPIO3 IO 预留 

33 GPIO4/WAKE I GPIO4/ 模组休眠用法时的被 DTE 唤醒管脚，高 

电平被唤醒 

34 GND P 电源地 

35 RF_ANT IO 射频天线焊盘， 50 Ω 特性阻抗 

36 GND P 电源地 

37 GND P 电源地 

38 DEG_RXD I 调试串口接收，建议预留接口便于调试 

39 DEG_TXD O 调试串口发送，建议预留接口便于调试 

40 GND P 电源地 

41 GND P 电源地 

42 VDD P 电源输入，电压范围： 2.6V-3.6V ，典型 3.3V 

43 VDD P 电源输入，电压范围： 2.6V-3.6V ，典型 3.3V 

44 NC NC NC 网络拓扑图： 

·支持中心节点到任意节点通信，如 FFFE--0005--0009 ；

·支持普通节点间通信，无需强行交付到中心节点转发，如 0009--0006--

0007 ；

·支持普通节点通过任意中心节点地址找到具备北向出口的中心节点， 如

0009--0005--FFFE/0009--0005--FFFD; 

## 4.1. 通信地址定义 

通信地址由上位机配置提供，使用 2 字节标识， 通信地址的配置决定了模 组在网络中的角色， 通信地址使用规则如下： 

地址范围 描述 

0xFFFF 任意中心节点 

0xFFFE~0xFFBE 中心节点地址范围 

0xFFBD~0xFF7D 组播地址 

0xFF7C~0xFF00 保留 

0x0000 广播地址 

0x0001~0xFEFF 普通节点地址 

## 4.2. 按需组网 

当需要组建一个自组网时，即节点充当网络中的汇聚角色，做以下步骤： 

1）配置小区号，类似业务切片，用于区分不同业务的通信； 

2）配置中心节点段的通信地址； 

3）等待下游节点的路由建立或者主动向下游节点发送业务报文； 

当一个新的节点需要加入到已有的自组网时，做以下步骤： 

1）配置小区号，用于识别不同的业务切片； 

2）配置普通节点段的通信地址； 

3）发送业务报文； 

a. 当普通节点不清楚中心节点的具体通信地址时，可以在发送指令中 

指 示目 标地 址 为任 意中 心节 点 （ 0xFFFF ） 就可 以与 中 心节 点建 立通 信 

（AT+SEND=FFFF,len,data,type ），建立成功后会通过 URC 推送告知上位 

机具体的中心节点地址（ +ROUTE:CREATE ADDR[0x FFXX ]）； 

b. 当普通节点已经建立与中心节点的路由关系后，依然可以使用任意 

中心节点 (0xFFFF) 通信或者指定具体的中心节点地址通信； 

## 4.3. 多中心节点 

本网络中至少存在一个中心节点，当然也支持多个中心节点的存在； 当网络中存在多个中心节点时，中心节点间是允许相互通信的； 

当节点发起任意中心节点的路由发现时，会收到多个中心节点的路由应答， 

此时节点的后续数据的目标地址如果仍然是任意中心节点时，节点会选择距离 

本节点跳数最少的一个中心节点发送； 

当所有节点都是中心节点时，此时网络就变为纯 MESH 网络； 

## 4.4. 多备选路径 

在本路由方案中，允许保留到目标节点的多条有效路径，每次发送时都会 

选择最优路径进行发送，当传送过程中发现路径不可达时，会选择另外的备选 

路径进行数据的送达，从而增加数据的可达性； 

## 4.5. 路径优化 

路径的优化对于网络的稳定性和性能来说都是重要的存在，本方案中通过 

以下几个维度进行路径的优化： 

1）基于邻居信息的更新 

节点间会通过 MAC 层的通信握手交换路由状态，利用空口信号的特点， 

节点可以偷听到邻居的握手信息，从而更新自己的路由信息；如节点 X

到中心节点 A 的路径是 X-C-B-A ，现在在 X 节点附近新增了一个节 点

Y，其中 Y 可以直达中心节点 A，在 Y 和 A 交互过程中， X 偷听到 Y

和 A 的握手信息，得知 Y 存在更加短的路径时， X 就会向 Y 的方向尝 

试建立到 A 的路由，从而实现路径的动态优化； 

2）基于电量的路径均衡 

每个节点在工作时都会记录自己的收发工况从而推断自身的耗电情况， 

依据耗电百分比来决定转发意愿，当一个节点的电量消耗较大时，转发 

意愿就会降低，在与其他节点握手的过程中告知邻居，让邻居选择转发 

意愿更高的节点转发，从而实现基于电量的路径均衡； 

3）手动配置静态路径 

业务的运营方可以依据业务特性进行路径的静态配置，通过中心节点就 

可以把静态路径配置下去。 4.6. 跳频通信 

本方案支持 470MHz~510MHz 的全频段跳频通信，从而提高抗干扰能力； 

节点间通信是通过握手信道进行初步协商，然后在数据信道进行数据收 

发，最终回到握手信道进行数据确认，基于上述的基本通信逻辑，把跳频 

分为握手跳频和数据跳频； 

利用无线特性，握手信道会从每个频段中挑选一个出来，节点在发送握 

手信号时随机从握手信道中挑选一个，等待邻居应答后，就会从剩余的频 

点中协商一个信道作为后续的数据收发信道。 

由于每次的数据信道（含重传）都是依据可靠通信策略选择的不同频点， 

可以在无线环境较为复杂的环境下提高通信的成功率。 

## 4.7. 发送对象 

依据业务数据发送的对象不同，可以分为以下几种： 

1）点播发送 

a. 最为常见的发送方式，由一端发起给另外一端的通信方式，经过路 

由节点进行定向数据转发； 

b. 节点不管是什么角色，都可以向指定地址的另外一个节点进行点播 

通信，无需强行交由中心节点进行转发； 

c. 提供任意中心地址的方式让节点轻易找到北向出口； 

2）组播发送 

a. 每个节点都可以配置一个组播地址； 

b. 当节点发送指定组地址的组播报文时，属于该组地址的其他节点接 

收并处理报文，其余节点依据自身条件转发该报文； 

c. 每个节点都可以发送组播报文，只是传播的范围有所不同，中心节 

点发送的组播报文可以辐射整个网络，而普通节点发送的组播报文仅限于 

其邻居； 

3）广播发送 

a. 当节点收到广播报文时，其余节点接收并处理广播报文，并且依据 自身条件转发该报文； 

b. 每个节点都可以发送广播报文，只是传播的范围有所不同，中心节 

点发送的广播报文可以辐射整个网络，而普通节点发送的广播报文仅限于 

其邻居； 

4）泛洪发送 

a. 当节点发送泛洪报文时，全网节点都会收到相同的泛洪报文； 

b. 不受制于网络拓扑，就在邻居间进行数据的传递； 

c. 当节点收到泛洪报文时，接收并处理泛洪报文，并且依据自身的条 

件转发该报文； 

## 4.8. 送达确认模式 

假如网络拓扑为 A-B-C-D-E ，当 A 发送数据给 E 时，本方案中提供了以下 

两种数据送达确认模式： 

1）UM ，数据交付给目标节点后，目标节点无需回应送达确认报文给源节 

点，通信可靠性依赖邻居节点间的握手机制（节点间可靠，全链路不可靠）； 

a. A 发送给 B 后知道 B 已经成功接收到数据，但是后续节点如何就依 

靠 节 点 间 的 可 靠 传 输 机 制 决 定 ， 所 以 此 时 A 收 到 B 的 接 收 应 答 

（+SEND:sn,SEND OK ）时，认为已经发送成功，实际上 E 是否收到不确定； 

2）AM ，数据交付给目标节点后，目标节点需回应送达确认报文给源节点， 

通信可靠性依赖邻居节点间的握手机制（节点间可靠，全链路可靠）； 

a. A 发送给 B 后知道 B 已经成功接收，最后数据经过中间节点转发 到

E 时 ， E 会 返 回 一 个 应 答 报 文 给 A ， 所 以 A 最 终 能 收 到 B 的 送 达 确 认 

（+SEND:sn,SEND OK ）和 E 的送达确认（ +ACK: <SRC >,<RSSI >,<SN >），从 

而得知数据真实到达了目标节点； 

## 4.9. 功耗模式 

在本系统中，目前支持两种功耗模式，分别是 Type C 和 Type D 模式。 

1）Type C 模式是低功耗模式，在 Type C 模式下 

a. 节点射频休眠时会进入空口侦听状态（可以通过指令配置侦听周 

期），其他节点可以通过发送空口唤醒信号唤醒本节点； b. 节点收到业务数据时， 会拉低 RI 脚，并且在 120ms 后推送业务报 

文给上位机； 

c. 上位机需要与模组交互时，需要拉高 WAKE 脚并且等待 +READY 推送 

后再发送 AT 指令； 

2）Type D 模式是非低功耗模式，在 Type D 模式下 

a. 节点射频处于常接收状态； 

b. 上位机与模组的交互无需额外的 IO 动作； 

在缺省配置下： 

·中心节点角色工作在 TYPE D 模式下； 

·普通节点角色工作在 TYPE C 模式下； 

也可以通过 AT 指令配置具体的工作模式。 

## 4.10. 低功耗组网 

自组网的网络部署中，会经常出现只有中心节点是市电供电，其余的节点 

都是采用电池供电的情况，这个时候就必须要求普通节点在组网过程中采用更 

加低的功耗方式； 

节点在组网过程中，功耗消耗通常受以下几个因素影响： 

1）广播转发的深度，即节点转发路由请求的范围，范围越大总体消耗的能 

量越多； 

2）广播转发的密度，即节点发起路由请求的次数，次数越密集总体消耗的 

能量越多； 

当一个存在中心的树状拓扑内，如果在网络部署时，中心节点没有被布置 

到网络中，此时如果下游节点发起路由发现时，只会导致路由发现报文在节点 

内盲目转发，导致整个网络造成一波一波的网络风暴，这对于存在低功耗需求 

的系统来说是灾难性的。 

针对上述场景，本方案设计了一套低功耗的组网策略，即使出现无中心节 点的情况，也不会出现广播风暴，并且当中心节点就绪后，可以有序地以中心 

节点为圆心进行逐层建网，并且全程以点播地方式进行，从而进一步降低路由 

开销。 

## 4.11. 大文件代理传输 

对于物联网应用来说， OTA 几乎是一个必选项，不管对于通信模组本身还 

是上位机应用都是如此，而通信模组本身具备 OTA 功能，为了降低上位机应用 

的开发难度，模组开放大文件传输通道给上位机，此时上位机只需要把升级包 

或者是大的配置包打包通过 AT 指令传输给中心节点，并且命令中心节点往下 

游节点传输即可，中间的拆组包过程由通信协议栈负责，最终下游节点收完大 

文件后会通过 URC 指令告知上位机，上位机只需要通过 AT 指令就可以从模组 

中取出大文件。 

## 4.12. 参考指标 

## 4.12.1. 时延 

由于串口波特率可配置，所以下面传输耗时的起始点是模组收完串口指令， 

结束点是协议栈接收完数据，准备往 AT 口发送； 

由于空口唤醒时间可配置，所以下面传输耗时不包含唤醒时间，如果配置 

了唤醒周期需要每跳额外加上唤醒帧发送发送时间； 

空口速率 业务报文长度 耗时 网络拓扑 

76800 50 21ms@ 快速发送 

40ms@UM 发送 

二级一跳 

76800 200 40ms@ 快速发送 

58ms@UM 发送 

二级一跳 

76800 50 80ms@ 快速发送 

153ms@UM 发送 

五级四跳 

76800 200 153ms@ 快速发送 

229ms@UM 发送 

五级四跳 

19200 50 45ms@ 快速发送 二级一跳 83ms@UM 发送 

19200 200 111ms@ 快速发送 

150ms@UM 发送 

二级一跳 

19200 50 201ms@ 快速发送 

358ms@UM 发送 

五级四跳 

19200 200 466ms@ 快速发送 

618ms@UM 发送 

五级四跳 

## 4.12.2. 待机功耗 

空口速率 唤醒周期（ ms ） 平均待机功耗（ uA ）

19200 200 223 

19200 500 90 

19200 1000 46 

19200 2000 24 

76800 200 127 

76800 500 44 

76800 1000 21 

76800 2000 12 

## 4.12.3. 发送功耗 

发送功率（ dBm ） 功耗峰值（ mA ）

20 116 

17 68 

10 35 

0 21 1. AT 指令详细描述 

## 1.1. AT 接口配置 

模组 出厂默认配置为 1152 00 bps,8N1 。

8: 表示 8 位数据位 ;

N:表示无校验 ;

1:表示 1 位停止位 。

## 1.2. AT 指令 

传感采集终端模组和上位机之间的软件通信通过 AT 指令集实现。 AT 指令 

集是一种应用于 AT 服务器 (AT Server) 与 AT 客户端 (AT Client) 间的设备连接与 

数据通信的方式。一般 AT 指令 由三个部分组成，分别是 :前缀、主体和结束符。 

其中前缀由字符 AT 构成；主体由命令、参数和可能用到的数据组成；结束符 

一般为 ("\r\n") 。“AT”两个字符 ,总是用来启动从 TE( 上位机 AT Client )发送到 TA 

(模组 AT Server )的命令行 1

。AT 数据分为 AT 请求命令数据，请求命令的响应数 

据+结果， URC 数据。 URC 数据为非请求结果码（ Unsolicited Result Code ）， 

特指 AT Server 主动发送给 AT Client 的数据。一般在特殊情况才会发送，比如 

无线连接断开、通知传感器上位机接收数据等，具有一定的随机性。 

## 1.3. 命令格式 

命令使用 ASCII 码字符串，有 3 种格式，分别如下 :

执行格式 AT+<CMD><CR><LF>      

> 1定义来自 <3GPP TS 07.07 V7.8.0 (2003-03) >

查询格式 AT +<CMD>?<CR><LF> 

配置格式 AT +<CMD>=< 参数 1>[, 参数 2]...[, 参数 n]<CR><LF> 

说明 :

1. 命 令 以 "AT +" 开 头 ,<CR><LF> （ 回 车 换 行 符 ,16 进 制 值 为 0x0D 0x0A ，即

"\r\n" ，下文相同）结尾； 

2. <>: 表示必须包含的部分； 

3. []: 表示可选的部分 ;

4. 命令 参数 不区分大小写 ；

5. 输入参数不能出现连续两个或多个逗号； 

6. AT 指令执行返回的结果前都添加指令内容 (如+<CMD>:) ，后续的格式说明中 

不再显式描述，可参考具体示例。 

命令执行的返回主要有以下几种 类型 :

返回格式 描述 

+<CMD>:" OK "<CR><LF> 表示成功，多见于执行和配置类命令的返 

回

+<CMD>:" ERROR "<CR><LF> 表示失败，多见于执行和配置类命令的返 

回

+<CMD>:" ERROR,1 "<CR><LF> 表示输入的指令无法识别 

+<CMD>:" ERROR,2 "<CR><LF> 表示能够识别指令，但输入参数无效，多 

见于配置类命令的返回 

## 1.4. 命令分类说明 

模组 AT 命令集分为以下几类 : 通用指令，通信指令， URC 指示。 URC 指示为模 

组主动发出，通用指令和通信指令为上位机发送给模组的 AT 指令。 

## 1.5. 通用指令 

## 1.5.1. AT 

描述 测试串口通信正常 

格式 AT\r\n 

返回 OK\r\n 

参数 无备注 无

示例 发送 :AT\r\n 

返回 :+AT: OK\r\n 

## 1.5.2. 配置 AT 串口 UART 

描述 配置 AT 串口参数 

格式 AT+UART= <BAUD >,< DATA >,< STOP >,< PARITY >,< FLOW >,< ADDCHK >\r\n 

返回 成功： OK\r\n 

失败： ERROR\r\n 或 ERROR,2\r\n ，参见 2.1 

参数 

BAUD ：串口波特率； 

支持波特率 1200/2400/4800/9600/19200/38400/ 

57600/115200/230400/460800/921600/1000000 

DATA ：数据位数， 8 表示 8bit 数据，其他保留； 

STOP ：停止位， 1 表示 1 个停止位，其他保留； 

PARITY ：校验， 0 表示不校验， 1 表示 ODD 奇校验， 2 表示 EVE N

偶校验，其他保留 ；

FLOW: 流控， 0 表示无流控，其他保留； 

ADDCHK: 前面所有参数之和； 

备注 对指令的回复在原始的配置下返回 

示例 发送 :AT+UART=115200,8,1,0,0,115209 \r\n 

返回 :+UART:OK\r\n 

## 1.5.3. 查询 AT 串口 UART 

描述 查询 AT 串口参数 

格式 AT+UART? \r\n 

返回 成功： <BAUD >,< DATA >,< STOP >,< PARITY >,< FLOW >\r\n OK\r\n 

失败： ERROR\r\n ，参见 2.1 

参数 参数描述参考 2.3.8 

备注 示例 

发送 :AT+UART? \r\n 

返回 :+UART:9600,8,1,0,0\r\nOK\r\n 

## 1.5.4. 查询固件版本 VER 

描述 查询固件版本 

格式 AT+VER?\r\n 

返回 [版本 号]_[发布日期 ]_[哈希值 ]_[ 型号 ]\r\nOK\r\n 

参数 无

备注 无

示例 发送 :AT+VER?\r\n 

返回 :+VER: V1. 2.3_T2 3111 1_12345678 _TP1 502 \r\nOK\r\n 

## 1.5.5. 软重启 REBOOT 

描述 重启模组 

格式 AT+REBOOT \r \n 

返回 成功 :OK \r\n 

参数 无

备注 返回 OK ，然后系统自动重启 

示例 发送 :AT+REBOOT \r \n 

返回 :+REBOOT:OK \r\n 

## 1.5.6. 查询 ESN 

描述 查询模组 ESN 

格式 AT+ESN? \r \n 

返回 成功 :+ESN:[ESN]\r\nOK \r\n 

参数 无

备注 

示例 发送 :AT+ESN \r \n 返回 :+ESN:FF0000000001\r\nOK \r\n 

## 1.6. 配置指令 

## 1.6.1. 配置通信地址 ADDR 

描述 配置通信地址 

格式 AT+ ADDR=<addr>[,<group_addr>] \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 

<addr> : 通信地址（ Hex, 2Byte ）,中心节点范围 

[0xFFBE,0xFFFE]; 普通节点范围 [1,0xFEFF] 

[group_addr]: 组播地址（ Hex, 2Byte ），范围 

[0xFF7D,0xFFBD] 

备注 配置完成后会自动重启； 

示例 发送 :AT+ ADDR=0001,ffaa \r\n 

返回 :+ADDR: OK\r\n 

## 1.6.2. 查询通信地址 ADDR 

描述 查询通信地址 

格式 AT+ ADDR? \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 

ROOT[ 是否中心节点 ]\n 

ADDR[ 点播地址 ]\n 

GROUP_ADDR[ 组播地址 ]\n 

备注 ROOT 表示是否为中心节点， 1 为是 0 为不是； 

示例 发送 :AT+ ADDR? \r\n 返回 :+ADDR: 

ROOT[1]\r\n 

ADDR[0x0001]\r\n 

GROUP_ADDR[0xFFAA]\r\n 

OK\r\n 

## 1.6.3. 配置小区 ID 

描述 配置发射功率 

格式 AT+CELL =<value> \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 <value> : 小区 ID 值范围 [0, 255] ，0 表示无特别 CELL 处理， 

默认值为 255 

备注 执行成功后重启 

示例 发送 :AT+CELL =20\r\n 

返回 :+CELL :OK\r\n 

## 1.6.4. 查询小区 ID 

描述 查询发射功率 

格式 AT+CELL ?\r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 [小区 ID]\n 

备注 

示例 

发送 :AT+CELL ?\r\n 

返回 :+CELL :255 \r \n 

OK\r\n 1.6.5. 配置发射功率 PWR 

描述 配置发射功率 

格式 AT+ PWR=<value> \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 <value> : 发射功率值范围 [-30, 36 ]，单位 dBm 

备注 

本指令配置空口发送功率； 

发送功率会依据具体硬件的情况（ PA 参数）进行最大最小值的适 

配

示例 发送 :AT+ PWR= 15\r\n 

返回 :+PWR: OK\r\n 

## 1.6.6. 查询发射功率 PWR 

描述 查询发射功率 

格式 AT+ PWR? \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 [发射功率值 ]\n 

备注 

示例 

发送 :AT+ PWR? \r\n 

返回 :+PWR: 15 \r \n 

OK\r\n 

## 1.6.7. 配置唤醒周期 WOR 

描述 配置通信地址 

格式 AT+ WOR=< period >\r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 参数 <period > : 唤醒周期，可选值 

100/200/300/500/1000/2000/3000 单位 ms 

备注 配置完成后会自动重启； 

示例 发送 :AT+ WOR= 200\r\n 

返回 :+WOR: OK\r\n 

## 1.6.8. 查询唤醒周期 WOR 

描述 查询唤醒周期 

格式 AT+ WOR? \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 [period] 单位 ms 

备注 

示例 

发送 :AT+ WOR? \r\n 

返回 :+WOR: 1000 \r \n 

OK\r\n 

## 1.6.9. 配置通信速率 BPS 

描述 配置通信速率 

格式 AT+ BPS=<type>,< bps >\r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 

<type > : 信道类型，可选值 CT RL 或者 DATA 

<bps> : 信道速率，可选值为 19200/38400/76800 

备注 配置完成后会自动重启； 

示例 发送 :AT+ BPS=CTRL, 19200\r\n 

返回 :+BPS: OK\r\n 1.6.10. 查询通信速率 BPS 

描述 查询通信速率 

格式 AT+ BPS? \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 CTRL[ 控制信道速率 ]\r \n 

DATA[ 数据信道速率 ]\r \n 

备注 

示例 

发送 :AT+ BPS? \r\n 

返回 :+BPS: CTRL [1 9200 ]\r \n 

DATA [19200 ]\r \n 

OK\r\n 

## 1.6.11. 配置功耗模式 LP 

描述 配置功耗模式 

格式 AT+ LP=<value> \r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 <value> : 2 表示 TYPE C；3 表示 TYPE D

备注 配置成功后会重启 

示例 发送 :AT+ LP=3 \r\n 

返回 :+LP: OK\r\n 

## 1.6.12. 查询功耗模式 LP 

描述 查询功耗模式 

格式 AT+ LP? \r\n 返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 [功耗模式 ]\n 

备注 

示例 

发送 :AT+ LP? \r\n 

返回 :+LP:3\r \n 

OK\r\n 

## 1.6.13. 配置持续工作时间 AWAKE 

描述 配置持续工作时间 

格式 AT+AWAKE =< value >\r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 

<value >: MAC 会话结束后 , 持续监听时间；单位 ms 

0: 表示会话结束后直接按照功耗类型休眠或者监听处理； 

[2 00 ,65535] : 表示会话结束后持续监听 配置时间的控制信道 

后，再按照功耗类型处理 

备注 

示例 发送 :AT+AWAKE =500\r\n 

返回 :+AWAKE :OK\r\n 

## 1.6.14. 查询持续工作时间 AWAKE 

描述 查询持续工作时间 

格式 AT+AWAKE ?\r\n 

返回 参数错误返回 ERROR2 

执行成功返回 OK 

参数 [当前 持续工作时间 ]\r \n 

备注 示例 

发送 :AT+AWAKE ?\r\n 

返回 :+AWAKE :500 \r \n

OK\r\n 

## 1.7. 通信指令 

## 1.7.1. 数据发送 SEND 

描述 数据发送 

格式 AT+SEND =<ADDR>, <LEN >,< DATA >,<TYPE> \r \n 

返回 参数校验成功 :OK \r\n 

无效参数 :ERROR ,2\r\n 

参数 

ADDR: 接收数据的目标地址（ Hex, 2Byte ）

LEN: 需要发送数据的长度（ Dec ），范围 [1,400] 

DATA :需要发送的数据 (Hex )

TYPE :消息类型 

0: UM, 发送数据无需接收者送达确认； 

1: AM, 发送数据需要接收者送达确认； 

2:FAST, 减少握手次数快速发送（无需接收者送达确认）； 

3:FLOOD, 泛洪发送； 

备注 

1）普通节点如果需要向中心节点发送数据但是不知道中心节点 

的具体地址，可以在 ADDR 中填 FFFF 表示任意中心节点； 

2）如果是 AM 类型，目标地址不能是广播、组播地址； 

3）如果是 FAST 类型，目标地址不能是广播、组播地址； 

4）如果是 FLOOD 类型，目标地址只能是广播地址； 

5）发送过程使用 URC 异步输出，参考 2. 6.8 

示例 

发送 :AT+SEND =FFFF,5,0123456789,0 \r\n 

返回 :+SEND:OK\r\n 

完整样例参考 2. 6.8 1.8. URC 指示 

## 1.8.1. 模组完成重启 

描述 完成重启 

格式 +BOOT\r\n 

返回 N/A 

参数 

备注 模组完成重启后时输出 

示例 

## 1.8.2. 模组 AT 接口就绪 

描述 AT 接口就绪 

格式 +READY\r\n 

返回 N/A 

参数 

备注 可以开始接收 AT 指令 

示例 

## 1.8.3. 路由创建 

描述 新节点路由创建指示 

格式 +ROUTE:CREATE ADDR[ 节点地址 ]\r\n 

返回 N/A 

参数 

备注 新节点路由创建时输出 

示例 +ROUTE:CREATE ADDR[0xFFFE]\r\n 

## 1.8.4. 路由删除 

描述 节点路由删除指示 

格式 +ROUTE:DELETE ADDR[ 节点地址 ]\r\n 

返回 N/A 

参数 备注 节点路由删除时输出 

示例 +ROUTE:DELETE ADDR[0xFFFE]\r\n 

## 1.8.5. 模组进入休眠 

描述 模组进入休眠 

格式 +SUSPEND\r\n 

返回 N/A 

参数 

备注 模组进入休眠时输出 

示例 

## 1.8.6. 模组退出休眠 

描述 模组退出休眠 

格式 +RESUME\r\n 

返回 N/A 

参数 

备注 模组退出休眠时输出 

示例 

## 1.8.7. 数据接收 

描述 接收数据 

格式 +NNMI:<SRC>,<DEST>,<RSSI>,<LEN>,<DATA>\r\n 

返回 N/A 

参数 

SRC: 数据源地址（ Hex, 2Byte ）

DEST: 数据的目标地址（ Hex, 2Byte ）

RSSI: 综合链路 RSSI ，范围 [-127,-1] 

LEN: 接收数据的长度（ Dec ）

DATA :接收的数据 (Hex, Ascii) 

备注 模组接收到数据时输出 DEST 为 0000 时表示广播接收 

DEST 为组播地址时表示组播接收 

DEST 为自己地址时表示点播接收 

示例 +NNMI:FFFE,0001,-80,10,00112233445566778899\r\n 

## 1.8.8. 数据发送过程 

描述 在发送数据期间，存在若干个阶段或者执行结果，通过该指示输 

出。 

格式 +SEND:<SN>,<RESULT>\r\n 

返回 N/A 

参数 

SN: 模组在接收发送报文时，为其分配一个需要用于跟踪后续的 

发送状态变更， 0 表示异常指示， [1,63] 循环使用； 

RESULT: 发送阶段，参考以下描述 

HANDLE OK: 成功添加到发送队列； 

HANDLE ERROR: 添加到发送队列失败 (队列已满 ); 

PREPARE: 开始执行发送； 

SEND OK: 送达成功； 

SEND ERROR: 超时未能送达； 

JOINING: 正在建立路由； 

ROUTE FULL ：路由已满； 

备注 无

示例 

发送 :AT+SEND =FFFF,5,0123456789,0 \r\n 

立即 返回 :+SEND:OK\r\n 

URC 阶段： 

成功示例： 

+SEND:10,HANDLE OK\r\n 

+SEND:10,PREPARE\r\n 

+SEND:10,SEND OK\r\n 失败示例 1（发送超时）： 

+SEND:10,HANDLE OK\r\n 

+SEND:10,PREPARE\r\n 

+SEND:10,SEND ERROR\r\n 

失败示例 2（队列已满）： 

+SEND:0,HANDLE ERROR\r\n 

失败示例 3（路由建立中）： 

+SEND:0,JOINING\r\n 

## 1.8.9. 送达确认 

描述 收到送达确认指示 

格式 +ACK: <SRC >,<RSSI >,<SN >\r\n 

返回 N/A 

参数 

SRC 表示送达确认的发送方 

RSSI 表示综合链路 RSSI 

SN 表示 SEND 指令返回的 SN 序号 

备注 收到送达确认时输出 

示例 +ACK:FFFE,-80,10\r\n 

## 1.8.10. 泛洪数据接收 

描述 泛洪数据接收 格式 +FLOOD:<SRC>,<LEN>,<DATA>\r\n 

返回 N/A 

参数 

SRC: 数据源地址（ Hex, 2Byte ）

LEN: 接收数据的长度（ Dec ）

DATA :接收的数据 (Hex, Ascii) 

备注 收到泛洪数据时输出 

示例 +FLOOD:0001,10,00112233445566778899\r\n 官方微信公众号 

联系电话： 020-32640281-815 

联系邮箱： jx@techphant.net 

官方网站： www.techphant.cn
